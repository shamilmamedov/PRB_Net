name: PN_resnet_sweep_7seg_LFK
method: random
metric:
  goal: minimize
  name: loss_val

parameters:  
  n_seg: 
    value: 7
  DLO:
    value: pool-noodle

  # Dataset
  train_trajs: 
    value:
      - 1
      - 2
      - 3
      - 5
      - 6
      - 7
  val_trajs:
    value:
      - 4

  data_seed:
    value: 812
  batch_size:
    value: 64
  rollout_length:
    value: 250
  n_epochs:
    value: 25 

  # Rollout legnth scheduler
  rollout_length_scheduler:
    parameters:
      init_value: 
        value: 0.1
      boundaries:
        values:
          - 10
      scales:
        values:
          - 10

  # Dynamics model
  model_seed:
    value: 42

  encoder:
    parameters:
      type: 
        value: PINN
      width: 
        values:
          - 64
          - 128
      depth: 
        value: 2
      activation: 
        value: tanh

  dynamics:
    parameters:
      type: 
        value: ResNet
      n_u: 
        value: 18
      width: 
        values:
          - 64
          - 128
      depth: 
        value: 2
      activation: 
        values:
          - relu6
          - tanh

  decoder:
    parameters:
      type: 
        value: TrainableFKDecoder
      n_y: 
        value: 6

  # Optimizer
  optimizer: 
    value: adamw
  learning_rate_scheduler: 
    value: polynomial 
  initial_learning_rate:
    values:
      - 0.001
      - 0.002
      - 0.003
  final_learning_rate:
    value: 0.00001
  polynomial_power:
    values:
      - 0.5
      - 1.0
      - 1.5
  weight_decay:
    values:
      - 0.0001
      - 0.001
      - 0.01

  # Cost function weights
  q_rfem_l2: 
    value: 0.5
  dq_rfem_l2: 
    value: 0.05
